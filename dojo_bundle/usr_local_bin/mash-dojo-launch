#!/usr/bin/env bash
set -euo pipefail

# Launch the Dojo menu (ncurses) ðŸ¥‹
# - If we're in a terminal, run directly.
# - If we're not (e.g. autostart), open Konsole.

DOJO="/usr/local/lib/mash/dojo/dojo.sh"

if [[ ! -x "$DOJO" ]]; then
  echo "âŒ Dojo entrypoint not found: $DOJO" >&2
  exit 1
fi

if [[ -t 1 ]]; then
  exec "$DOJO"
fi

# No TTY: try to spawn Konsole
if command -v konsole >/dev/null 2>&1; then
  exec konsole --new-tab -e bash -lc "$DOJO; echo; read -rp 'Press Enter to closeâ€¦ ' _"
fi

# Fallback: xterm
if command -v xterm >/dev/null 2>&1; then
  exec xterm -e bash -lc "$DOJO; echo; read -rp 'Press Enter to closeâ€¦ ' _"
fi

# Last resort: just run (will likely do nothing visible)
exec "$DOJO"
